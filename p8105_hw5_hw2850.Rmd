---
title: "p8105_hw5_hw2850"
author: "Haoyang Wang"
date: "2022-11-06"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r} 
library(tidyverse)
library(rvest)
```

#Problem 2
```{r}
homicide_raw = read_csv("data/homicide-data.csv") %>% 
  janitor::clean_names()
```
The raw data contains the homicides victims' information including the reported
date, victims' names, victims' age, victims' race, victims' sex, the cities and
the states that homicides occurred, the precise location of homicides (latitude,
longitude), and the disposition/result of homicides. 

```{r}
homicide_city_state = read_csv("data/homicide-data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(.data = ., city_state = str_c(city, ", " ,state)) %>% 
  select(-city, -state) %>% 
  mutate(
    disposition = if_else(disposition %in% c("Closed without arrest", "Open/No arrest"), "unsolved_homicides", "homicides")
  )
```
Combine variables "cities" and "states" into one variable "city_state". Group "Closed without arrest" and "Open/No arrest" into category "unsolved homicides". Group "Closed by arrest" into category "homicides".

```{r}
homicide_by_cities = homicide_city_state %>% 
  group_by(city_state, disposition) %>% 
  summarize(n_obs = n())
```
Summarize within cities to obtain the total number of homicides and the number of unsolved homicides.

```{r}
homicide_pivot = pivot_wider(
  homicide_by_cities,
  names_from = "disposition",
  values_from = "n_obs") 

homicide_pivot[is.na(homicide_pivot)] <- 0 #Change Tulsa, AL NA value to 0
```
Pivot_wider the homicide_by_cities dataset.

```{r}
homicide_pivot = 
  mutate(homicide_pivot,
  total = homicides + unsolved_homicides)
```
Add a total column for the total number of homicides.

```{r}
Baltimore = homicide_pivot %>% 
  filter(city_state == "Baltimore, MD")
```
Filter dataset with only city Baltimore, MD.



