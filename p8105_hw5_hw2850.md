p8105_hw5_hw2850
================
Haoyang Wang
2022-11-06

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
    ## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
    ## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
    ## ✔ readr   2.1.2      ✔ forcats 0.5.2 
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(rvest)
```

    ## 
    ## Attaching package: 'rvest'
    ## 
    ## The following object is masked from 'package:readr':
    ## 
    ##     guess_encoding

\#Problem 2

``` r
homicide_raw = read_csv("data/homicide-data.csv") %>% 
  janitor::clean_names()
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

The raw data contains the homicides victims’ information including the
reported date, victims’ names, victims’ age, victims’ race, victims’
sex, the cities and the states that homicides occurred, the precise
location of homicides (latitude, longitude), and the disposition/result
of homicides.

``` r
homicide_city_state = read_csv("data/homicide-data.csv") %>% 
  janitor::clean_names() %>% 
  mutate(.data = ., city_state = str_c(city, ", " ,state)) %>% 
  select(-city, -state) %>% 
  mutate(
    disposition = if_else(disposition %in% c("Closed without arrest", "Open/No arrest"), "unsolved_homicides", "homicides")
  )
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Combine variables “cities” and “states” into one variable “city_state”.
Group “Closed without arrest” and “Open/No arrest” into category
“unsolved homicides”. Group “Closed by arrest” into category
“homicides”.

``` r
homicide_by_cities = homicide_city_state %>% 
  group_by(city_state, disposition) %>% 
  summarize(n_obs = n())
```

    ## `summarise()` has grouped output by 'city_state'. You can override using the
    ## `.groups` argument.

Summarize within cities to obtain the total number of homicides and the
number of unsolved homicides.

``` r
homicide_pivot = pivot_wider(
  homicide_by_cities,
  names_from = "disposition",
  values_from = "n_obs") 

homicide_pivot[is.na(homicide_pivot)] <- 0 #Change Tulsa, AL NA value to 0
```

Pivot_wider the homicide_by_cities dataset.

``` r
homicide_pivot = 
  mutate(homicide_pivot,
  total = homicides + unsolved_homicides)
```

Add a total column for the total number of homicides.

``` r
Baltimore = homicide_pivot %>% 
  filter(city_state == "Baltimore, MD")
```

Filter dataset with only city Baltimore, MD.

``` r
Baltimore_proptest = prop.test(
  x = pull(Baltimore, unsolved_homicides),
  n = pull(Baltimore, total)) %>% 
  broom::tidy() %>% 
  select(estimate, conf.low, conf.high)
```

Do prop.test with city Baltimore data. The estimate proportion of
unsolved homicides is 0.6455607. The confidence interval is between
0.6275625 and 0.6631599.
